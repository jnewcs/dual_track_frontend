(this.webpackJsonpdual_track_frontend=this.webpackJsonpdual_track_frontend||[]).push([[5],{91:function(e,t,n){"use strict";n.r(t);var s=n(87),c=n(34),a=n(4),i=n(16),r=n(17),o=n(18),l=n(19),u=n(1),b=n(88),d=n.n(b),h=n(6),m=n.n(h),j=n(10),f=n(14),v=n(0),O=function(){var e=Object(u.useState)(null),t=Object(f.a)(e,2),n=t[0],s=t[1],c=Object(u.useState)(!1),a=Object(f.a)(c,2),i=a[0],r=a[1];if(!("wakeLock"in navigator))return null;var o=function(){var e=Object(j.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.wakeLock.request("screen");case 3:t=e.sent,s(t),r(!0),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("".concat(e.t0.name,", ").concat(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),l=function(){n&&n.release(),s(null),r(!1)};return Object(v.jsx)(v.Fragment,{children:i?Object(v.jsx)("div",{className:"button",tabIndex:"0",onClick:l,onKeyUp:function(e){return"Enter"===e.key&&l()},children:"Unlock Page"}):Object(v.jsx)("div",{className:"button",tabIndex:"0",onClick:o,onKeyUp:function(e){return"Enter"===e.key&&o()},children:"Lock Page"})})},p=function(){var e=Object(u.useState)(!!document.fullscreenElement),t=Object(f.a)(e,2),n=t[0],s=t[1],c=function(){document.documentElement.requestFullscreen(),s(!0)},a=function(){document.exitFullscreen(),s(!1)};return Object(v.jsx)(v.Fragment,{children:n?Object(v.jsx)("div",{className:"button",tabIndex:"0",onClick:a,onKeyUp:function(e){return"Enter"===e.key&&a()},children:"Leave Full Screen"}):Object(v.jsx)("div",{className:"button",tabIndex:"0",onClick:c,onKeyUp:function(e){return"Enter"===e.key&&c()},children:"Enter Full Screen"})})};function x(e){var t=e/36e5,n=60*(t-Math.floor(t)),s=Math.floor(n),c=60*(n-s),a=Math.floor(c),i=100*(c-a),r=Math.floor(i),o=s.toString().padStart(2,"0"),l=a.toString().padStart(2,"0"),u=r.toString().padStart(2,"0");return"".concat(o,":").concat(l,":").concat(u)}var g=function(e){var t=e.showReset,n=void 0===t||t,s=e.onPlayCallback,c=void 0===s?function(){}:s,a=e.onStopCallback,i=void 0===a?function(){}:a,r=Object(u.useState)(!1),o=Object(f.a)(r,2),l=o[0],b=o[1],d=Object(u.useState)(null),h=Object(f.a)(d,2),m=h[0],j=h[1],O=Object(u.useState)(0),p=Object(f.a)(O,2),g=p[0],y=p[1],k=Object(u.useState)(null),N=Object(f.a)(k,2),S=N[0],w=N[1],C=function(){l?(clearInterval(S),i()):(j(Date.now()-g),c()),b(!l)};Object(u.useEffect)((function(){if(null===m)clearInterval(S),w(null),y(0);else{var e=setInterval((function(){y(null===m?0:Date.now()-m)}),10);w(e)}}),[m]);var E=function(){j(null),b(!1)};return Object(v.jsxs)("div",{className:"box has-text-centered is-flex is-flex-direction-column is-align-items-center",children:[Object(v.jsx)("h2",{className:"is-size-2 mb-3",children:"Stopwatch"}),Object(v.jsx)("div",{className:"stopwatch-circle circle is-flex is-justify-content-center is-align-items-center",children:Object(v.jsx)("span",{className:"time is-size-2",id:"display",children:g?x(g):"00:00:00"})}),Object(v.jsxs)("div",{className:"mt-3 is-flex is-justify-content-space-between",children:[Object(v.jsx)("img",{className:"is-clickable mr-5",tabIndex:0,id:"main-action-button",alt:l?"pause stopwatch":"start stopwatch",src:l?"https://res.cloudinary.com/https-tinloof-com/image/upload/v1593360448/blog/time-in-js/pause-button_pinhpy.svg":"https://res.cloudinary.com/https-tinloof-com/image/upload/v1593360448/blog/time-in-js/play-button_opkxmt.svg",onClick:C,onKeyUp:function(e){return"Enter"===e.key&&C()}}),n&&Object(v.jsx)("img",{className:"is-clickable",tabIndex:0,id:"reset-button",alt:"reset stopwatch",src:"https://res.cloudinary.com/https-tinloof-com/image/upload/v1593360448/blog/time-in-js/reset-button_mdv6wf.svg",onClick:E,onKeyUp:function(e){return"Enter"===e.key&&E()}})]})]})},y=n(3),k=function(e){var t=e.members,n=Object(y.f)().email;return!t||t.count<2?null:Object(v.jsxs)("h5",{className:"chat-title is-size-5",children:["People in Chat",Object(v.jsx)("br",{}),Object.values(t).map((function(e){var t=e.email===n?"is-link":"is-light";return Object(v.jsx)("div",{className:"tag ".concat(t),children:e.email},e.email)}))]})},N=function(e){var t=e.open,n=e.members,s=e.chatHistory,c=e.closeChat,a=e.message,i=e.setMessage,r=e.sendMessage,o=Object(y.f)().email;return!t||!n||Object.values(n).length<2?null:Object(v.jsxs)("div",{className:"chat-interface box has-background-link-light p-5",children:[Object(v.jsx)("div",{tabIndex:0,className:"delete is-clickable is-size-3 close-chat-interface",onClick:c,onKeyUp:function(e){return"Enter"===e.key&&c()},dangerouslySetInnerHTML:{__html:"&#215;"}}),Object(v.jsx)(k,{members:n}),Object(v.jsxs)("div",{className:"chat-messages box mt-2 p-3",children:[Object(v.jsx)("div",{className:"is-full-width is-flex is-justify-content-center mb-4",children:Object(v.jsx)("div",{className:"tag is-dark",children:"This is the beginning of your conversation history"})}),s.map((function(e,t){return e.sender===o?Object(v.jsx)("div",{className:"is-full-width is-flex is-justify-content-flex-end mb-2",children:Object(v.jsx)("div",{className:"tag is-medium is-link from-me-message is-pulled-right",children:e.message})},"chat-me-".concat(t)):Object(v.jsx)("div",{className:"mb-2",children:Object(v.jsx)("div",{className:"tag is-medium is-light to-me-message",children:e.message})},"chat-others-".concat(t))})),Object(v.jsx)("div",{id:"last-chat-element"})]}),Object(v.jsx)("div",{className:"chat-send-box box mt-2 p-3",children:Object(v.jsxs)("div",{className:"is-flex",children:[Object(v.jsx)("input",{className:"input is-normal",type:"text",placeholder:"Enter your message",value:a,onChange:function(e){return i(e.target.value)},onKeyUp:function(e){return"Enter"===e.key&&r()}}),Object(v.jsx)("div",{className:"button is-primary ml-2",tabIndex:0,onClick:r,disabled:!a||!a.length,children:"Send"})]})})]})},S=function(e){var t=e.showChat,n=e.channel,c=e.chatHistory,a=e.setChatHistory,i=e.unreadMessage,r=e.setUnreadStatus,o=e.members,l=Object(u.useState)(!1),b=Object(f.a)(l,2),d=b[0],h=b[1],m=Object(u.useState)(""),j=Object(f.a)(m,2),O=j[0],p=j[1],x=Object(y.f)().email;if(Object(u.useEffect)((function(){var e=document.getElementById("last-chat-element");e&&e.scrollIntoView()}),[c,d]),Object(u.useEffect)((function(){var e=function(e){27===e.keyCode&&g(!1)};d?document.addEventListener("keydown",e,!1):document.removeEventListener("keydown",e,!1)}),[d]),!n||!t)return null;var g=function(){d?document.body.classList.remove("not-vertically-scrollable"):(r(!1),document.body.classList.add("not-vertically-scrollable")),h(!d)};return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("button",{className:"button",tabIndex:0,onClick:g,disabled:Object.values(o).length<2,onKeyUp:function(e){return"Enter"===e.key&&g()},children:["Workout Chat",i&&Object(v.jsx)("div",{className:"dot ml-1 has-background-primary"})]}),Object.values(o).length<2&&Object(v.jsx)("div",{className:"mt-2",children:"Waiting for others to join the workout :)"}),Object(v.jsx)(N,{open:d,members:o,chatHistory:c,closeChat:function(){g(!1)},message:O,setMessage:p,sendMessage:function(){if(O&&O.length){var e={id:c.length+1,sender:x,message:O,timestamp:Date.now()};n.trigger("client-chat-message",e),a([].concat(Object(s.a)(c),[e])),p("")}}})]})},w=n(9),C=function(e){Object(o.a)(n,e);var t=Object(l.a)(n);function n(e){var s;Object(i.a)(this,n),(s=t.call(this,e)).setChatHistory=function(e){s.setState({chatHistory:e})},s.setUnreadStatus=function(e){s.setState({unreadMessage:e})},s.state={chatHistory:[],unreadMessage:!1,members:[],showChat:!1};return d.a.logToConsole=!1,s.pusher=new d.a("cebc878343c66e63a78e",{cluster:"us3",authEndpoint:"".concat("https://glacial-plateau-65219.herokuapp.com","/pusher/auth"),auth:{headers:{Authorization:localStorage.getItem("currentUserToken")||""}}}),s.channel=s.pusher.subscribe("presence-workoutChannel-".concat(s.identifier)),s}return Object(r.a)(n,[{key:"identifier",get:function(){return this.props.match.params.identifier}},{key:"componentDidMount",value:function(){var e=this;this.channel.bind("pusher:subscription_succeeded",(function(e){this.setState({members:e.members,showChat:!0})}),this),this.channel.bind("pusher:member_added",(function(e){var t=Object(a.a)(Object(a.a)({},this.state.members),{},Object(c.a)({},e.id,e.info));this.setState({members:t})}),this),this.channel.bind("pusher:member_removed",(function(e){var t=this,n=Object.keys(this.state.members).filter((function(t){return"".concat(t)!=="".concat(e.id)})).reduce((function(e,n){return e[n]=t.state.members[n],e}),{});this.setState({members:n})}),this),this.channel.bind("client-chat-message",(function(t){e.setState({chatHistory:[].concat(Object(s.a)(e.state.chatHistory),[Object(a.a)({},t)]),unreadMessage:!0})}),this)}},{key:"componentWillUnmount",value:function(){this.pusher.unsubscribe("presence-workoutChannel-".concat(this.identifier)),this.channel&&this.channel.unbind(),document.body.classList.remove("not-vertically-scrollable")}},{key:"render",value:function(){return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("nav",{className:"breadcrumb","aria-label":"breadcrumbs",children:Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:Object(v.jsx)(w.b,{to:"/workouts",className:"",children:"Workouts"})}),Object(v.jsx)("li",{className:"is-active",children:Object(v.jsx)("div",{className:"ml-3",children:"Workout - 150m Workout"})})]})}),Object(v.jsxs)("div",{className:"buttons",children:[Object(v.jsx)(O,{}),Object(v.jsx)(p,{})]}),Object(v.jsx)(g,{}),Object(v.jsx)(S,Object(a.a)({channel:this.channel,setChatHistory:this.setChatHistory,setUnreadStatus:this.setUnreadStatus},this.state))]})}}]),n}(u.Component);t.default=C}}]);
//# sourceMappingURL=5.458ac164.chunk.js.map