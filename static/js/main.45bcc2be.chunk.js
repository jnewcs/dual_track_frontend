(this.webpackJsonpdual_track_frontend=this.webpackJsonpdual_track_frontend||[]).push([[0],{60:function(e,t,n){},61:function(e,t,n){},76:function(e,t){},93:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(42),s=n.n(c),i=n(12),o=n(7),l=(n(60),n(61),n(3)),d=n(5),u=n.n(d),j=n(10),h=n(63),b="https://glacial-plateau-65219.herokuapp.com",v={success:!0},m={success:!1};function p(e,t){return e({type:"REQUEST_LOGIN"}),h.post("".concat(b,"/login")).send(t).set("Content-Type","application/json").set("Accept","application/json").end((function(t,n){console.log("Login Request: ",t,n);var a=n.body.email;if(!t&&a){var r=n.headers.Authorization;return e({type:"LOGIN_SUCCESS",payload:{email:a,token:r}}),localStorage.setItem("currentUserEmail",a),localStorage.setItem("currentUserToken",r),Object(l.g)().push("/dashboard"),v}return e({type:"LOGIN_ERROR",error:n.body.message||"Unhandled error while logging in :("}),m}))}function O(){return(O=Object(j.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("currentUserToken")||"",a={method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:n}},e.prev=2,t({type:"REQUEST_AUTH"}),e.next=6,fetch("".concat(b,"/users/check"),a);case 6:return r=e.sent,e.next=9,r.json();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}function f(){return(f=Object(j.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"LOGOUT"}),localStorage.removeItem("currentUserEmail"),localStorage.removeItem("currentUserToken");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g=n(14),x={email:localStorage.getItem("currentUserEmail")||"",token:localStorage.getItem("currentUserToken")||"",loading:!1,errorMessage:null},N=function(e,t){switch(t.type){case"REQUEST_LOGIN":case"REQUEST_AUTH":return Object(o.a)(Object(o.a)({},e),{},{loading:!0,errorMessage:null});case"LOGIN_SUCCESS":return Object(o.a)(Object(o.a)({},e),{},{email:t.payload.email,token:t.payload.token,loading:!1,errorMessage:null});case"LOGOUT":return Object(o.a)(Object(o.a)({},e),{},{email:"",token:"",errorMessage:null});case"LOGIN_ERROR":return Object(o.a)(Object(o.a)({},e),{},{loading:!1,errorMessage:t.error});default:throw new Error("Unhandled action type: ".concat(t.type))}},w=n(0),k=Object(a.createContext)(),y=Object(a.createContext)();function S(){var e=Object(a.useContext)(k);if(void 0===e)throw new Error("useAuthState must be used within a AuthProvider");return e}function E(){var e=Object(a.useContext)(y);if(void 0===e)throw new Error("useAuthDispatch must be used within a AuthProvider");return e}var C=function(e){var t=e.children,n=Object(a.useReducer)(N,x),r=Object(g.a)(n,2),c=r[0],s=r[1];return Object(w.jsx)(k.Provider,{value:c,children:Object(w.jsx)(y.Provider,{value:s,children:t})})},T=function(){var e=S();return Object(w.jsxs)("nav",{className:"navbar is-light",role:"navigation","aria-label":"main navigation",children:[Object(w.jsxs)("div",{className:"navbar-brand",children:[Object(w.jsx)("div",{className:"has-text-primary is-size-3 p-2",children:"DualTrack"}),Object(w.jsxs)("div",{role:"button",className:"navbar-burger","aria-label":"menu","aria-expanded":"false","data-target":"navbar-menu",children:[Object(w.jsx)("span",{"aria-hidden":"true"}),Object(w.jsx)("span",{"aria-hidden":"true"}),Object(w.jsx)("span",{"aria-hidden":"true"})]})]}),Object(w.jsxs)("div",{id:"navbar-menu",className:"navbar-menu",children:[Object(w.jsx)("div",{className:"navbar-start",children:Boolean(e.email)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(i.b,{to:"/dashboard",className:"navbar-item",activeClassName:"is-active",children:"Dashboard"}),Object(w.jsx)(i.b,{to:"/settings",className:"navbar-item",activeClassName:"is-active",children:"Settings"})]})}),Object(w.jsx)("div",{className:"navbar-end",children:Object(w.jsx)("div",{className:"navbar-item",children:Object(w.jsx)("div",{className:"buttons",children:!Boolean(e.email)&&Object(w.jsx)(i.b,{to:"/login",className:"button is-light",activeClassName:"is-active",children:"Login"})})})})]})]})},U=function(e){var t=e.history,n=E(),a=S();return Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{className:"",children:[Object(w.jsx)("h1",{className:"is-size-1 mb-5",children:"Dashboard"}),Object(w.jsxs)("div",{className:"buttons",children:[Object(w.jsx)("button",{className:"button is-default",onClick:function(){!function(e){f.apply(this,arguments)}(n),t.push("/login")},children:"Logout"}),Object(w.jsx)("button",{className:"button is-default",onClick:function(){return function(e){return O.apply(this,arguments)}(n)},children:"Check Auth"})]})]}),Object(w.jsx)("p",{children:"Welcome to the dashboard ".concat(a.email,"!")})]})},I=function(e){var t=e.history,n=S(),r=n.email,c=n.loading,s=n.errorMessage;Object(a.useEffect)((function(){r&&t.push("/dashboard")}),[r,t]);var i=Object(a.useState)(""),o=Object(g.a)(i,2),l=o[0],d=o[1],h=Object(a.useState)(""),b=Object(g.a)(h,2),v=b[0],m=b[1],O=E(),f=function(){var e=Object(j.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),p(O,{user:{password:v,email:l}});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)("div",{className:"columns is-centered",children:Object(w.jsxs)("div",{className:"column is-half",children:[s&&Object(w.jsx)("p",{className:"notification is-danger",children:s}),Object(w.jsxs)("form",{children:[Object(w.jsxs)("div",{className:"field",children:[Object(w.jsx)("label",{className:"label",htmlFor:"email",children:"Email"}),Object(w.jsx)("div",{className:"control",children:Object(w.jsx)("input",{className:"input",autoComplete:"email",required:!0,type:"text",id:"email",disabled:c,value:l,onChange:function(e){return d(e.target.value)}})})]}),Object(w.jsxs)("div",{className:"field",children:[Object(w.jsx)("label",{className:"label",htmlFor:"password",children:"Password"}),Object(w.jsx)("div",{className:"control",children:Object(w.jsx)("input",{className:"input",autoComplete:"current-password",required:!0,type:"password",id:"password",disabled:c,value:v,onChange:function(e){return m(e.target.value)}})})]}),Object(w.jsx)("button",{type:"submit",className:"button is-primary mt-5",onClick:f,disabled:c,children:"Login"})]})]})})},L=function(){return Object(w.jsx)("h1",{className:"is-size-1 mb-5",children:"Page not found!"})},R=n(53),P=n(54),_=[{path:"/",component:I,isPrivate:!1},{path:"/login",component:I,isPrivate:!1},{path:"/dashboard",component:U,isPrivate:!0},{path:"/settings",component:function(){var e=Object(a.useState)(null),t=Object(g.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(!1),s=Object(g.a)(c,2),i=s[0],o=s[1];Object(P.a)((function(e){o(e)})),Object(a.useEffect)((function(){var e=document.getElementById("changelog-path").dataset.path;fetch(e).then((function(e){return e.json()})).then((function(e){var t=Object.keys(e).filter((function(e){return Object(R.a)(e,">".concat("0.1.0"))})).map((function(t){return{version:t,description:e[t].description}}));r(t)}))}),[]);return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h1",{className:"is-size-1 mb-5",children:"My Settings"}),Object(w.jsxs)("div",{className:"level mb-5",children:[Object(w.jsx)("div",{className:"level-item has-text-centered",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{className:"heading",children:"Tweets"}),Object(w.jsx)("p",{className:"title",children:"3,456"})]})}),Object(w.jsx)("div",{className:"level-item has-text-centered",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{className:"heading",children:"Following"}),Object(w.jsx)("p",{className:"title",children:"123"})]})}),Object(w.jsx)("div",{className:"level-item has-text-centered",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{className:"heading",children:"Followers"}),Object(w.jsx)("p",{className:"title",children:"456K"})]})}),Object(w.jsx)("div",{className:"level-item has-text-centered",children:Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{className:"heading",children:"Likes"}),Object(w.jsx)("p",{className:"title",children:"789"})]})})]}),Object(w.jsx)("hr",{}),i&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{id:"new-version-refresh-notification",className:"mb-5",children:Object(w.jsxs)("div",{className:"notification is-info is-light is-flex is-align-items-center",children:["A new version of DualTrack is available",Object(w.jsx)("div",{className:"button is-light ml-2",id:"new-version-refresh-button",onClick:function(){navigator.serviceWorker.getRegistration().then((function(e){e.waiting&&e.waiting.postMessage({type:"SKIP_WAITING"}),o(!1)}))},children:"Refresh to Update"})]})}),n&&n.map((function(e){return Object(w.jsxs)("div",{className:"box",children:[Object(w.jsx)("h3",{className:"is-size-3",children:e.version}),Object(w.jsx)("p",{children:e.description})]},e.version)}))]})]})},isPrivate:!0},{path:"/*",component:L,isPrivate:!1}],A=n(55),W=function(e){var t=e.component,n=e.path,a=e.isPrivate,r=Object(A.a)(e,["component","path","isPrivate"]),c=S();return Object(w.jsx)(l.b,Object(o.a)({path:n,render:function(e){return a&&!Boolean(c.email)?Object(w.jsx)(l.a,{to:{pathname:"/login"}}):Object(w.jsx)(t,Object(o.a)({},e))}},r))};var F=function(){return Object(w.jsxs)("div",{className:"app-container",children:[Object(w.jsx)(T,{}),Object(w.jsx)("div",{className:"container is-widescreen pt-5",children:Object(w.jsx)(l.d,{children:_.map((function(e,t){return Object(w.jsx)(W,Object(o.a)({exact:!0},e),t)}))})})]})};function G(e,t){var n;!function(){M.apply(this,arguments)}(),navigator.serviceWorker.register(e).then((function(e){console.log("[Registering SW]: ",e),e.waiting&&e.waiting.state,e.onupdatefound=function(){null!==(n=e.installing)&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller||(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}function M(){return(M=Object(j.a)(u.a.mark((function e(){var t,n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("serviceWorker"in navigator)){e.next=7;break}return e.next=3,navigator.serviceWorker.getRegistration();case 3:n=e.sent,a=n&&n.active,r=a&&a.state,navigator.serviceWorker.addEventListener("controllerchange",Object(j.a)(u.a.mark((function e(){var n,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,navigator.serviceWorker.getRegistration();case 4:n=e.sent,a=n&&n.active,c=a&&a.state,"activated"===r&&"activating"===c&&(t=!0,window.location.reload());case 8:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var z=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,94)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};n(22);s.a.render(Object(w.jsx)(r.a.StrictMode,{children:Object(w.jsx)(C,{children:Object(w.jsx)(i.a,{children:Object(w.jsx)(F,{})})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/dual_track_frontend",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/dual_track_frontend","/service-worker.js");z?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):G(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):G(t,e)}))}}(),B()}},[[93,1,2]]]);
//# sourceMappingURL=main.45bcc2be.chunk.js.map