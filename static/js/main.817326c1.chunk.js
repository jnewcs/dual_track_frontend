(this.webpackJsonpdual_track_frontend=this.webpackJsonpdual_track_frontend||[]).push([[0],{25:function(e,t,a){},36:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(18),s=a.n(c),i=a(9),o=a(4),l=(a(25),a(2)),u=a(1),d=function(){return Object(u.jsxs)("nav",{className:"navbar is-light",role:"navigation","aria-label":"main navigation",children:[Object(u.jsxs)("div",{className:"navbar-brand",children:[Object(u.jsx)("div",{className:"has-text-primary is-size-3 p-2",children:"DualTrack"}),Object(u.jsxs)("div",{role:"button",className:"navbar-burger","aria-label":"menu","aria-expanded":"false","data-target":"navbar-menu",children:[Object(u.jsx)("span",{"aria-hidden":"true"}),Object(u.jsx)("span",{"aria-hidden":"true"}),Object(u.jsx)("span",{"aria-hidden":"true"})]})]}),Object(u.jsxs)("div",{id:"navbar-menu",className:"navbar-menu",children:[Object(u.jsx)("div",{className:"navbar-start",children:Object(u.jsx)(i.b,{to:"/dashboard",className:"navbar-item",activeClassName:"is-active",children:"Dashboard"})}),Object(u.jsx)("div",{className:"navbar-end",children:Object(u.jsx)("div",{className:"navbar-item",children:Object(u.jsx)("div",{className:"buttons",children:Object(u.jsx)(i.b,{to:"/login",className:"navbar-item",activeClassName:"is-active",children:"Login"})})})})]})]})},j=a(8),b=a.n(j),h=a(11),p="//127.0.0.1:4000",O={success:!0},m={success:!1};function v(e,t){return x.apply(this,arguments)}function x(){return(x=Object(h.a)(b.a.mark((function e(t,a){var n,r,c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(a)},e.prev=1,t({type:"REQUEST_LOGIN"}),e.next=5,fetch("".concat(p,"/login"),n);case 5:return r=e.sent,e.next=8,r.json();case 8:if(!(c=e.sent).email){e.next=16;break}return s=r.headers.get("Authorization"),t({type:"LOGIN_SUCCESS",payload:{email:c.email,token:s}}),localStorage.setItem("currentUserEmail",c.email),localStorage.setItem("currentUserToken",s),e.abrupt("return",O);case 16:return t({type:"LOGIN_ERROR",error:c.message}),e.abrupt("return",m);case 20:return e.prev=20,e.t0=e.catch(1),t({type:"LOGIN_ERROR",error:"Unhandled error while logging in :("}),e.abrupt("return",m);case 24:case"end":return e.stop()}}),e,null,[[1,20]])})))).apply(this,arguments)}function f(){return(f=Object(h.a)(b.a.mark((function e(t){var a,n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=localStorage.getItem("currentUserToken")||"",n={method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:a}},e.prev=2,t({type:"REQUEST_AUTH"}),e.next=6,fetch("".concat(p,"/users/check"),n);case 6:return r=e.sent,e.next=9,r.json();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}function g(){return(g=Object(h.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"LOGOUT"}),localStorage.removeItem("currentUserEmail"),localStorage.removeItem("currentUserToken");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=a(13),w={email:localStorage.getItem("currentUserEmail")||"",token:localStorage.getItem("currentUserToken")||"",loading:!1,errorMessage:null},y=function(e,t){switch(t.type){case"REQUEST_LOGIN":case"REQUEST_AUTH":return Object(o.a)(Object(o.a)({},e),{},{loading:!0});case"LOGIN_SUCCESS":return Object(o.a)(Object(o.a)({},e),{},{email:t.payload.email,token:t.payload.token,loading:!1,errorMessage:null});case"LOGOUT":return Object(o.a)(Object(o.a)({},e),{},{email:"",token:"",errorMessage:null});case"LOGIN_ERROR":return Object(o.a)(Object(o.a)({},e),{},{loading:!1,errorMessage:t.error});default:throw new Error("Unhandled action type: ".concat(t.type))}},k=Object(n.createContext)(),S=Object(n.createContext)();function C(){var e=Object(n.useContext)(k);if(void 0===e)throw new Error("useAuthState must be used within a AuthProvider");return e}function E(){var e=Object(n.useContext)(S);if(void 0===e)throw new Error("useAuthDispatch must be used within a AuthProvider");return e}var U=function(e){var t=e.children,a=Object(n.useReducer)(y,w),r=Object(N.a)(a,2),c=r[0],s=r[1];return Object(u.jsx)(k.Provider,{value:c,children:Object(u.jsx)(S.Provider,{value:s,children:t})})},T=function(e){var t=e.history,a=Object(n.useState)(""),r=Object(N.a)(a,2),c=r[0],s=r[1],i=Object(n.useState)(""),o=Object(N.a)(i,2),l=o[0],d=o[1],j=E(),p=function(){var e=Object(h.a)(b.a.mark((function e(a){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),n={user:{password:l,email:c}},e.prev=2,e.next=5,v(j,n);case 5:if(e.sent.success){e.next=8;break}return e.abrupt("return");case 8:t.push("/dashboard"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),O=C(),m=O.loading,x=O.errorMessage;return Object(u.jsx)("div",{className:"",children:Object(u.jsxs)("div",{className:"",children:[Object(u.jsx)("h1",{children:"Login Page"}),x&&Object(u.jsx)("p",{className:"",children:x}),Object(u.jsxs)("form",{children:[Object(u.jsxs)("div",{className:"",children:[Object(u.jsxs)("div",{className:"",children:[Object(u.jsx)("label",{htmlFor:"email",children:"Username"}),Object(u.jsx)("input",{type:"text",id:"email",disabled:m,value:c,onChange:function(e){return s(e.target.value)}})]}),Object(u.jsxs)("div",{className:"",children:[Object(u.jsx)("label",{htmlFor:"password",children:"Password"}),Object(u.jsx)("input",{type:"password",id:"password",disabled:m,value:l,onChange:function(e){return d(e.target.value)}})]})]}),Object(u.jsx)("button",{onClick:p,disabled:m,children:"Login"})]})]})})},I=[{path:"/",component:T,isPrivate:!1},{path:"/login",component:T,isPrivate:!1},{path:"/dashboard",component:function(e){var t=e.history,a=E(),n=C();return Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{className:"",children:[Object(u.jsx)("h1",{children:"Dashboard"}),Object(u.jsx)("button",{className:"",onClick:function(){!function(e){g.apply(this,arguments)}(a),t.push("/login")},children:"Logout"}),Object(u.jsx)("button",{className:"",onClick:function(){return function(e){return f.apply(this,arguments)}(a)},children:"Check Auth"})]}),Object(u.jsx)("p",{children:"Welcome to the dashboard ".concat(n.email,"!")})]})},isPrivate:!0},{path:"/*",component:function(){return Object(u.jsx)("div",{className:"",children:Object(u.jsx)("h1",{children:"Page not found"})})},isPrivate:!1}],P=a(20),L=function(e){var t=e.component,a=e.path,n=e.isPrivate,r=Object(P.a)(e,["component","path","isPrivate"]),c=C();return Object(u.jsx)(l.b,Object(o.a)({path:a,render:function(e){return n&&!Boolean(c.email)?Object(u.jsx)(l.a,{to:{pathname:"/login"}}):Object(u.jsx)(t,Object(o.a)({},e))}},r))};var R=function(){return Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)(d,{}),Object(u.jsx)(l.d,{children:I.map((function(e,t){return Object(u.jsx)(L,Object(o.a)({exact:!0},e),t)}))})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var _=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,37)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),c(e),s(e)}))};s.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(U,{children:Object(u.jsx)(i.a,{children:Object(u.jsx)(R,{})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),_()}},[[36,1,2]]]);
//# sourceMappingURL=main.817326c1.chunk.js.map